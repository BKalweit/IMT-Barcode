<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
    <title>IMT</title>
    <style>
        body {
            font-size: 20px;
        }
    </style>
</head>
<body>
<div class="app">
    <h1>IMT Application</h1>
    <div>
        <p>Hello.</p>
        <p id="status">Waiting for device...</p>
        <p>x: <span id="accelx">-</span></p>
        <p>y: <span id="accely">-</span></p>
        <p>z: <span id="accelz">-</span></p>
        <button onclick="doTest()" style="width: 100px; height: 100px;">Do Test!</button>
    </div>
    <div>
        <p>Barcodes</p>
        <p id="status2">-</p>
        <button onclick="scanBarcode1()" style="width: 100px; height: 100px;">Scan Barcode 1</button>

    </div>
</div>
<script type="text/javascript" src="phonegap.js"></script>
<script type="text/javascript">

    var app = {
        // Application Constructor
        initialize: function() {
            this.bindEvents();
        },

        bindEvents: function() {
            document.addEventListener('deviceready', this.onDeviceReady, false);
        },

        onDeviceReady: function() {
            document.getElementById('status').innerText = 'Device is ready.';
        }
    };

    app.initialize();

    var timeoutHandle = null;

    function doTest() {
        function onSuccess(acceleration) {

            document.getElementById('accelx').innerText = acceleration.x;
            document.getElementById('accely').innerText = acceleration.y;
            document.getElementById('accelz').innerText = acceleration.z;

        };

        function onError() {
            alert('onError!');
        };

        if(!timeoutHandle) {
            document.getElementById('status').innerText = 'Polling accelerometer data...';
            timeoutHandle = setInterval(function() {
                navigator.accelerometer.getCurrentAcceleration(onSuccess, onError);
            }, 100);
        } else {
            clearInterval(timeoutHandle);
            timeoutHandle = null;
            document.getElementById('status').innerText = 'Device is ready.';
        }
    }



    function scanBarcode1() {

        cordova.plugins.barcodeScanner.scan(
                function (result) {
                    alert("We got a barcode\n" +
                            "Result: " + result.text + "\n" +
                            "Format: " + result.format + "\n" +
                            "Cancelled: " + result.cancelled);
                },
                function (error) {
                    alert("Scanning failed: " + error);
                }
        );

    }

</script>
</body>
</html>
